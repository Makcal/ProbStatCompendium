# Одна старая, одна новая с.в.
Дано: $\xi$, $p_\xi(x)$, $\eta = f(\xi)$ — новая случайная величина как-то **выражена** ($f(x)$, везде следует сразу подставлять $f$. Например, если $\eta=\xi^2$, то везде вместо $f(y)$ пишем сразу $y^2$) через известную.
Найти: $p_\eta(y)$
## Дискретный случай

Идём по определению и используем то, что известно:
$p_\eta(y)=P(\eta=y)=P(f(\xi)=y)$
Чтобы применить распределение $\xi$ и найти эту вероятность, самым простым [[Вероятность с случайными величинами|способом]] из *возможных* в общем случае будет перебрать значения $\xi$, для которых условие \[события\] выполняется.
$$P(f(\xi)=y)=\sum_xI(f(x)=y)P(\xi=x)=\sum_{\text{All }x\text{'s that cond is true}}p_\xi(x)$$
В конце добавить к $p_\eta(y)$ индикатор на те значения $y$, которые в принципе могут получиться в функции $f$ из значений $\xi$, если его легко определить, иначе можно подставлять $p_\xi(x)$ вместе с его индикатором.
#### Пример
Дано: $\eta=\xi^2, f(x)=x^2$, $p_\xi(x) = \frac12(1-p)^{|x|-1}p\cdot I(|x| \in \set{1,2,...})$ (я добавил геометрическому распределению отрицательные числа с равной вероятностью положительным, отсюда модуль и $\frac12$)
$$p_\eta(y)=P(\eta=y)=P(\xi^2=y)=P(\xi=\sqrt{y}) + P(\xi=-\sqrt{y})=p_\xi(\sqrt{y})+p_\xi(-\sqrt{y})=$$
$$=\frac12(1-p)^{|\sqrt y|-1}p\cdot I(|\sqrt y| \in \set{1,2,...})
+\frac12(1-p)^{|-\sqrt y|-1}p\cdot I(|-\sqrt y| \in \set{1,2,...})=$$
$$=\frac12(1-p)^{\sqrt y-1}p\cdot I(\sqrt y \in \set{1,2,...})
+\frac12(1-p)^{\sqrt y-1}p\cdot I(\sqrt y \in \set{1,2,...})=$$
$$=(1-p)^{\sqrt{y}-1}p\cdot I(\sqrt y \in \set{1,2,3,...}) =$$
$$=(1-p)^{\sqrt{y}-1}p\cdot I(y \in \set{1,4,9,...})$$
## Непрерывный случай
1. Искать саму $F_\xi(x)$ не требуется.
2. Выразить $F_\eta$ через $F_\xi$. Обычно результат таков:
$$F_\eta(y)=P(\eta\le y)=P(f(\xi)\le y)=P(\xi \in [a, b])=F_\xi(b)-F_\xi(a) \text{ (не подставлять }F_\xi\text{)}$$
	где $a$ и $b$ — это некоторые выражения с $y$, подобранные так, чтобы событие осталось эквивалентным $f(\xi)\le y$. То есть надо [[Неравенства|решить неравенство]] относительно $\xi$. Теоретически, может получиться и ситуация, где в эквивалентном событии надо объединить несколько отрезков.
3. Подставить $a,b$ и найти производные: $p_\eta(y)=F_\eta'(y)=[F_\xi(b)-F_\xi(a)]'=p_\xi(b)\cdot b'-p_\xi(a)\cdot a'$
4. Добавить индикатор с теми значениями $\eta$, которые могут получиться из $f$ из значений $\xi$.
#### Пример
$\xi\sim\mathcal{N}(0,1),\eta=\xi^2$
1. $F_\eta(y)=P(\eta\le y)=P(\xi^2\le y)=P(-\sqrt{y}\le\xi\le\sqrt{y})=F_\xi(\sqrt{y})-F_\xi(-\sqrt{y})$
2. $p_\eta(y)=F_\eta'(y)=p_\xi(\sqrt{y})\frac{1}{2\sqrt{y}}-p_\xi(-\sqrt{y})\frac{-1}{2\sqrt{y}}=\frac{1}{\sqrt y}\frac{1}{\sqrt{2\pi}}e^{-\frac12y}$
3. Дописать $I(y\ge0)$
# Несколько исходных с.в.
Дано: $\xi,\eta$, $p_{\xi,\eta}(x,y)$, $\zeta = f(\xi,\eta)$ — новая случайная величина как-то **выражена** ($f(x,y)$, везде следует сразу подставлять $f$. Например, если $\zeta=\xi+\eta$, то везде вместо $f(x,y)$ пишем сразу $x+y$) через известную.
Найти: $p_\zeta(z)$
## Дискретный случай
 По определению, затем перебираем значения $\xi,\eta$, чтобы получить $z$:
 $$p_\zeta(z)=P(\zeta=z)=P(f(\xi,\eta)=z)=\sum_x\sum_yI(f(x,y)=z)p_{\xi,\eta}(x,y)=\sum_{\text{such }x\text{'s and }y\text{'s}}\sum_{\text{that cond is true}}p_{\xi,\eta}(x,y)$$
 Зачастую достаточно перебирать только одну переменную, потому что вторую можно посчитать, **решив уравнение** $f(x,y)=z$, зная первую и $z$:
 $$P(f(\xi,\eta)=z)=\sum_yP(\xi=f^{-1}(z,y),\eta=y)=\sum_yp_{\xi,\eta}(f^{-1}(z,y),y)$$
 Подставить pmf с индикаторами и аккуратно посчитать.
#### Пример
$\zeta=\xi+\eta$
$$p_\zeta(z)=P(\xi+\eta=z)=\sum_yP(\xi=z-y,\eta=y)$$
## Непрерывный случай
Аналогично последнему, но с интегралами.
Перебираем значения $\xi,\eta$, чтобы получить $z$. Перебираем только одну переменную, потому что вторую можно посчитать, **решив уравнение** $f(x,y)=z$, зная первую и $z$:
 $$p_\zeta(z)=\int_{-\infty}^{+\infty}p_{\xi,\eta}(f^{-1}(z,y),y)dy$$
 Подставить pmf с индикаторами и аккуратно посчитать.
#### Пример
$\zeta=\xi+\eta,\; \xi,\eta\sim Uni(0,1)$, independent
$p_{\xi,\eta}(x,y)=p_\xi(x)p_\eta(y)=1\cdot I(x,y\in(0,1))$
Решаем уравнение относительно $\xi$: $\xi+\eta=z$, $\xi=z-\eta$. Заменяем $\eta$ на дополнительную переменную $y$.
Аккуратно [[Индикаторы|решаем интеграл с индикатором]]:
$$p_\zeta(z)=\int_{-\infty}^{+\infty}p_{\xi,\eta}(z-y,y)dy=\int_{-\infty}^{+\infty}I(z-y\in(0,1))I(y\in(0,1))dy = \int_0^1I(z-y\in(0,1))dy =$$
$$= \int_0^1I(y\in(z-1,z))dy = I(z>0)I(z-1<1)\int_{\max(0,z-1)}^{\min(1,z)} dy = (\min(1,z)-\max(0,z-1))I(z\in(0,2))$$
Из $\min,\max$ получаем четыре (два) кейса: $1<z,0<z-1$ и $1\ge z,0\ge z-1$ (и не забываем про общий индикатор на $(0,2)$):
$$p_\zeta(z)=\begin{cases}
2-z\text{ if }z\in(0,1) \\
z\text{ if }z\in[1,2)
\end{cases}$$